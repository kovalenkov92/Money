(function () {
  "use strict";
  var main = angular.module('main', [
    'ui.router',
    'templates',
    'ui.bootstrap',
    'dndLists'
  ]);

  main.run(['$http', '$rootScope', function($http, $rootScope){
    var csrf_token = $('meta[name="csrf-token"]').attr('content');
    $http.defaults.headers.common['X-CSRF-Token'] = csrf_token;
    $http.defaults.headers.common['Time-Offset']  = -(new Date().getTimezoneOffset() / 60);
  }]);

  main.config(['$urlRouterProvider', '$stateProvider', function ($urlRouterProvider, $stateProvider) {

    $urlRouterProvider.otherwise('/');

    $stateProvider
      .state('root', {
        url: '/',
        templateUrl: "<%= asset_path('application/templates/index.html') %>",
        controller: "IndexCtrl"
      })
      .state('date-time', {
        url: '/date_time',
        templateUrl: "<%= asset_path('application/templates/date-time.html') %>",
        controller: 'TestCtrl'
      })
      .state('carousel', {
        url: '/carousel',
        templateUrl: "<%= asset_path('application/templates/carousel.html') %>",
        controller: 'TestCtrl'
      })
      .state('dnd', {
        url: '/dnd',
        templateUrl: "<%= asset_path('application/templates/dnd.html') %>",
        controller: 'TestCtrl'
      })
      .state('chart', {
        url: '/chart',
        templateUrl: "<%= asset_path('application/templates/chart.html') %>",
        controller: 'ChartCtrl'
      })
  }]);

}());